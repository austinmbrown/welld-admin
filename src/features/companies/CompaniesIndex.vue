<template>
  <img v-if="loading" class="loader" src="@/assets/loader.gif">
  <table v-else-if="companies.length > 0">
    <tr>
      <th>ID</th>
      <th>Company</th>
      <th>Sign up token</th>
      <th>Fitness Clubs</th>
      <th>Programs</th>
    </tr>
    <tr v-for="company in companies" :key="company.id">
      <td>{{company.id}}</td>
      <td>{{company.name}}</td>
      <td>{{company.employee_signup_token}}</td>
      <td>
        <p v-for="club in company.fitness_clubs">{{club.name}}</p>
      </td>
      <td>
        <p v-for="program in company.club_programs">{{program.name}}</p>
      </td>
    </tr>
  </table>
</template>

<script>
  import {mapState, mapActions} from 'vuex'

  export default {
    computed: {
      ...mapState({
        companies: state => state.companies.companies,
        loading: state => state.companies.loading
      })
    },
    methods: {
      ...mapActions({
        fetchCompanies: 'companies/fetchCompanies'
      })
    },
    created() {
      this.fetchCompanies()
    }
  }
</script>

<style>
  table, tr {
    border: 1px solid #2c3e50;
    border-collapse: collapse;
    margin: auto;
    min-width: 40%;
  }
  tr:first-of-type {
    border-bottom: 2px solid #2c3e50;
  }
  td, th {
    border: 1px solid #2c3e50;
    padding: 4px;
  }
  td > p {
    margin: 2px;
  }
</style>
